name: Build Minimal WSA

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Prepare environment (no snap)
        run: |
          sudo apt-get update -y
          sudo apt-get upgrade -y git wget unzip python3 python3-pip p7zip-full aria2

      - name: Build WSA (Minimal Win10)
        run: |
          echo "==== Building WSA (minimal) ===="
          export TERM=dumb
          export NO_COLOR=1
          bash scripts/run.sh \
            --arch x64 \
            --release-type retail \
            --root-sol none \
            --gapps-variant none \
            --remove-amazon true \
            --windows-version 10 \
            --compress-format 7z

      - name: Upload Build Artifact
        uses: actions/upload-artifact@v4
        with:
          name: WSA_Win10_NoGApps
          path: output/*.7z
